<!DOCTYPE html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,300' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="us_state_landfill.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>

<style>
body {
  font-family: "Open Sans", sans-serif;
  font-size: 16px;
  padding: 20px;
}
</style>

<body>
    <h1>Pickup Yo Trash America!</h1>

    <div id='title_viz_instruct_text'>About:</div>
    <div class='viz_instruct_text'> This tool is to help you visualize how much trash is being hauled to landfills. The unit of measure is in tons.  Search any state and choose your metric: trash bin, dumpster or garbage truck. </div>

    <!-- input box for state search -->
  <!-- input box for gene search -->
    <div id='state_search_container' class='row'>
        <input id='state_search_box' type="text" class="form-control" placeholder="e.g. California" aria-describedby="sizing-addon2">

        <div id='gene_search_button' class="btn-group" data-toggle="buttons" >
        <label id='gene_search_submit' class="btn btn-primary active " onclick="return_state_info();">
            <input type="radio" name="options" id="" autocomplete="off" checked > Search
        </label>
        </div>
    </div>
      


    <p id = "datacite">Created by: Helen Li, Kalyn Bowen and Yuji Chan.</p>

   
<!-- <script src="//d3js.org/d3.v3.min.js"></script> -->
<script src="//d3js.org/queue.v1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.9.1/d3-tip.js"></script>
<script src="https://raw.githack.com/jamesleesaunders/d3-ez/master/dist/d3-ez.js"></script>

<script src="https://d3js.org/d3.v3.min.js"></script>

<script>

state_id_to_name = {
    AL: "Alabama",
    AK: "Alaska",
    AS: "American Samoa",
    AZ: "Arizona",
    AR: "Arkansas",
    CA: "California",
    CO: "Colorado",
    CT: "Connecticut",
    DE: "Delaware",
    DC: "District Of Columbia",
    FL: "Florida",
    GA: "Georgia",
    GU: "Guam",
    HI: "Hawaii",
    ID: "Idaho",
    IL: "Illinois",
    IN: "Indiana",
    IA: "Iowa",
    kS: "Kansas",
    KY: "Kentucky",
    LA: "Louisiana",
    ME: "Maine",
    MD: "Maryland",
    MA: "Massachusetts",
    MI: "Michigan",
    MN: "Minnesota",
    MS: "Mississippi",
    MO: "Missouri",
    MT: "Montana",
    NE: "Nebraska",
    NV: "Nevada",
    NH: "New Hampshire",
    NJ: "New Jersey",
    NM: "New Mexico",
    NY: "New York",
    NC: "North Carolina",
    ND: "North Dakota",
    OH: "Ohio",
    OK: "Oklahoma",
    OR: "Oregon",
    PW: "Palau",
    PA: "Pennsylvania",
    PR: "Puerto Rico",
    RI: "Rhode Island",
    SC: "South Carolina",
    SD: "South Dakota",
    TN: "Tennessee",
    TX: "Texas",
    UT: "Utah",
    VT: "Vermont",
    VI: "Virgin Islands",
    VA: "Virginia",
    WA: "Washington",
    WV: "West Virginia",
    WI: "Wisconsin",
    WY: "Wyoming"
}
/************* general GLOBAL variables here *************/
landfill_by_state = {} //total landfills in each state (Arkansa: 4)
landfill_by_state_list = []

var width = 1200, height = 600;
barHeight = height / 2 - 40
total_waste = 0
continue_display = true

    /************* PROCESS DATA ***********/
d3.csv("data_resources/state_landfill_mar2021.csv", function(error, data) {
  data.forEach(d => {
    let state_name = state_id_to_name[d.us_state]
    let landfill = d.landfill_name

    if (!(state_name in landfill_by_state)) {
      landfill_by_state[state_name] = {total_waste: 0, state_id: d.state_id, landfills: new Array(0)};
    } 
    landfill_by_state[state_name]['total_waste'] += d.annual_waste_acceptance ? parseInt(d.annual_waste_acceptance) : 0;
    total_waste += d.annual_waste_acceptance ? parseInt(d.annual_waste_acceptance) : 0;
    landfill_by_state[state_name]['landfills'].push(d);
})
    console.log(landfill_by_state);
    console.log(total_waste)
    
    Object.entries(landfill_by_state).forEach(e => {
    let landfills_sorted = e[1].landfills
    landfills_sorted.sort(function(a,b) { return parseInt(b.annual_waste_acceptance) - parseInt(a.annual_waste_acceptance); })
    landfill_by_state_list.push({state_name: e[0], total_waste: e[1].total_waste, landfills: landfills_sorted})
  })

  //left off trying to figure out how to portray correct waste amount, annual waste acceptance amount is not accessing landfill specific array

//   Object.entries(landfill_by_state).forEach(e => {
//     let countries_sorted = e[1].countries
//     countries_sorted.sort(function(a,b) { return parseInt(b.total_msw_total_msw_generated_tons_year) - parseInt(a.total_msw_total_msw_generated_tons_year); })
//     landfill_by_state_list.push({region_name: e[0], total_msw: e[1].total_msw, population: e[1].population, region_id: e[1].region_id, countries: countries_sorted})
//   })
//   document.getElementById('totalMsw').innerHTML=total_msw.toLocaleString()

});
</script>

</body>
</html>